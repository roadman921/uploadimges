<script>
const APPSCRIPT_URL = 'https://script.google.com/macros/s/AKfycbx3Hz8lZZ9NNBrd49uUlegJeea3hwsfLkUm4ENeu6xdzkD5e0xdTW7ed3QO_KpxR64lLw/exec';
const fileInput = document.getElementById('fileInput');
const uploadBtn = document.getElementById('uploadBtn');
const status = document.getElementById('status');

uploadBtn.addEventListener('click', async () => {
  const files = fileInput.files;
  if (!files || files.length === 0) return status.innerText = "Pick a file first";
  status.innerText = "Uploading...";

  for (let f of files) {
    const formData = new FormData();
    formData.append('file', f, f.name);

    try {
      const resp = await fetch(APPSCRIPT_URL, {
        method: 'POST',
        body: formData
      });
      const j = await resp.json();
      if (j.success) {
        status.innerHTML += `âœ… Uploaded: ${j.name}<br/>`;
      } else {
        status.innerHTML += `âŒ Failed: ${f.name} (${j.error})<br/>`;
      }
    } catch (err) {
      status.innerHTML += `ğŸš« Upload error: ${err.message}<br/>`;
    }
  }
});
</script>
